<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>To Do Html</title>
    <style>
        #title {
            text-align: center;
            margin: 25px;
        }
        
        #list {
            margin-left: 355px;
            width: 47%;
            height: 40px;
        }
        
        #table {
            width: 800px;
            margin-left: 355px;
        }
        
        #right {
            text-align: right;
        }
        
        #desc {
            text-align: center;
            margin: 30px;
        }
    </style>
</head>

<body>
    <h1 id="title">TO DO LIST</h1>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <form>
        <div class="mb-3">
            <input type="text" id="list">
            <input type="hidden" id="saveindex">
            <button type="submit" class="btn btn-primary btn-lg" id="btn">Add</button>
            <button type="button" class="btn btn-success btn-lg" id="savebtn" style="display: none;">save</button>
        </div>
    </form>
    <h3 id="desc">LIST</h3>
    <table id="table" class="table table-striped">
    </table>
    <script>
        //push the data
        show_list();
        let list = document.getElementById('list');
        let btn = document.getElementById('btn');
        let extra = 0;

        btn.addEventListener("click", function() {
            listvalue = list.value;
            for (let i = 0; i <= arraydata.length; i++) {
                if (listvalue == arraydata[i]) {
                    extra++;
                }
            }
            if (extra == 0) {
                if (listvalue.trim() != 0) {
                    var localdata = localStorage.getItem("todo_data");
                    if (localdata == null) {
                        arraydata = [];
                    } else {
                        arraydata = JSON.parse(localdata);
                    }
                    arraydata.push(listvalue);
                    localStorage.setItem("todo_data", JSON.stringify(arraydata));
                    show_list();
                    list.value = '';

                } else {
                    alert('fill the empty field');
                }
            } else {
                alert('value repeted');
            }
        })



        // for show the data in the list
        function show_list() {
            var localdata = localStorage.getItem("todo_data");
            if (localdata == null) {
                arraydata = [];
            } else {
                arraydata = JSON.parse(localdata);
            }
            let html = ``;
            let table = document.getElementById('table')
            arraydata.forEach((item, index) => {
                html += `<tr>
                <th>${index+1}</th>
                <td colspan="3">${item}</td>
                <td id="right"><button type="button" class="btn btn-success" onclick="editlist(${index})">Edit</button>
                <button type="button" class="btn btn-danger" onclick="deletelist(${index})">Delete</button></td>
            </tr>`;

            });
            table.innerHTML = html;
        }





        // for edit the data
        function editlist(index) {
            var saveindex = document.getElementById('saveindex');
            var btn = document.getElementById('btn');
            var savebtn = document.getElementById('savebtn');
            saveindex.value = index;
            var localdata = localStorage.getItem("todo_data");
            var arraydata = JSON.parse(localdata);
            list.value = arraydata[index];
            btn.style.display = "none";
            savebtn.style.display = "inline";
        }






        //for save after edit the data
        var savebtn = document.getElementById('savebtn');
        savebtn.addEventListener("click", function() {
            var extra1 = 0;
            let list = document.getElementById('list');
            listvalue = list.value;
            var localdata = localStorage.getItem("todo_data");
            var arraydata = JSON.parse(localdata);
            for (let i = 0; i <= arraydata.length; i++) {
                if (listvalue == arraydata[i]) {
                    extra1++;
                }
            }
            if (extra1 == 0) {
                if (listvalue.trim() != 0) {
                    var btn = document.getElementById('btn');
                    var localdata = localStorage.getItem("todo_data");
                    var arraydata = JSON.parse(localdata);
                    var saveindex = document.getElementById('saveindex').value;
                    arraydata[saveindex] = list.value;
                    savebtn.style.display = "none";
                    btn.style.display = "inline";
                    localStorage.setItem("todo_data", JSON.stringify(arraydata));
                    show_list();
                    list.value = '';
                } else {
                    alert('fill the empty field');
                }
            } else {
                alert('value repeted');
            }
        })








        //delete the data
        function deletelist(index) {
            var localdata = localStorage.getItem("todo_data");
            var arraydata = JSON.parse(localdata);
            if (confirm('are sure to want delete')) {
                arraydata.splice(index, 1)
            }
            localStorage.setItem("todo_data", JSON.stringify(arraydata));
            show_list();
        }
    </script>
</body>

</html>